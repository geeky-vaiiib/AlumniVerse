"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[335],{2869:function(e,n,l){l.d(n,{z:function(){return u}});var r=l(7437);l(2265);var t=l(7053),i=l(2163),o=l(7062);let a=(0,i.j)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg:not([class*='size-'])]:size-4 shrink-0 [&_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",{variants:{variant:{default:"bg-primary text-primary-foreground shadow-xs hover:bg-primary/90",destructive:"bg-destructive text-white shadow-xs hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60",outline:"border bg-background shadow-xs hover:bg-accent hover:text-accent-foreground dark:bg-input/30 dark:border-input dark:hover:bg-input/50",secondary:"bg-secondary text-secondary-foreground shadow-xs hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2 has-[>svg]:px-3",sm:"h-8 rounded-md gap-1.5 px-3 has-[>svg]:px-2.5",lg:"h-10 rounded-md px-6 has-[>svg]:px-4",icon:"size-9"}},defaultVariants:{variant:"default",size:"default"}});function u(e){let{className:n,variant:l,size:i,asChild:u=!1,...s}=e,d=u?t.g7:"button";return(0,r.jsx)(d,{"data-slot":"button",className:(0,o.cn)(a({variant:l,size:i,className:n})),...s})}},5351:function(e,n,l){l.d(n,{UserProvider:function(){return v},a:function(){return g}});var r=l(7437),t=l(2265),i=l(1883),o=l(2427);let a={github:/^https:\/\/github\.com\/[A-Za-z0-9_.-]+\/?$/,linkedin:/^https:\/\/(www\.)?linkedin\.com\/(in|pub)\/.+$/,leetcode:/^https:\/\/(www\.)?leetcode\.com\/[A-Za-z0-9_.-]+\/?$/};function u(e,n){if(!e||"string"!=typeof e)return null;let l=e.trim();if(!l)return null;let r=a[n];return r&&r.test(l)?l:null}function s(e){return u(e,"github")}function d(e){return u(e,"linkedin")}function c(e){return u(e,"leetcode")}let f=(0,t.createContext)(),p=e=>{let n=["firstName","lastName","currentCompany","designation","location","linkedinUrl","githubUrl","bio"];return Math.round(n.filter(n=>e[n]&&""!==e[n].trim()).length/n.length*100)},m=async e=>{try{let{data:n,error:l,status:r}=await o.OQ.from("users").select("*").eq("auth_id",e).single();if(!l)return{data:n,error:null};if(406===r||((null==l?void 0:l.message)||"").toLowerCase().includes("multiple")||((null==l?void 0:l.message)||"").toLowerCase().includes("results contain")){let{data:n,error:l}=await o.OQ.from("users").select("*").eq("auth_id",e).order("updated_at",{ascending:!1,nullsLast:!0}).limit(1);if(l)return{data:null,error:l};return{data:(null==n?void 0:n[0])||null,error:null}}return{data:null,error:l}}catch(e){return{data:null,error:e}}};function g(){let e=(0,t.useContext)(f);if(!e)throw Error("useUser must be used within UserProvider");return e}function v(e){let{children:n}=e,{user:l,session:a,isLoggedIn:u}=(0,i.a)(),[g,v]=(0,t.useState)(null),[h,b]=(0,t.useState)(!0),[_,U]=(0,t.useState)(null);(0,t.useEffect)(()=>{!async function(){if(!l||!u){v(null),b(!1);return}try{b(!0),console.log("UserContext: Fetching profile for user:",l.id);let e=l.user_metadata||{};console.log("UserContext: Auth metadata:",e);let{data:n,error:r}=await m(l.id);r&&console.error("UserContext: Database error:",r);let t={id:l.id,email:l.email,firstName:e.first_name||(null==n?void 0:n.first_name)||"",lastName:e.last_name||(null==n?void 0:n.last_name)||"",usn:e.usn||(null==n?void 0:n.usn)||"",branch:e.branch||(null==n?void 0:n.branch)||"",branchCode:e.branch_code||(null==n?void 0:n.branch_code)||"",joiningYear:e.joining_year||(null==n?void 0:n.admission_year)||null,passingYear:e.passing_year||(null==n?void 0:n.passing_year)||null,currentCompany:e.currentCompany||(null==n?void 0:n.company)||"Not specified",designation:e.designation||(null==n?void 0:n.current_position)||"Not specified",location:e.location||(null==n?void 0:n.location)||"Not specified",linkedinUrl:e.linkedinUrl||(null==n?void 0:n.linkedin_url)||"",githubUrl:e.githubUrl||(null==n?void 0:n.github_url)||"",leetcodeUrl:e.leetcodeUrl||(null==n?void 0:n.leetcode_url)||"",resumeUrl:e.resumeUrl||(null==n?void 0:n.resume_url)||"",bio:e.bio||(null==n?void 0:n.bio)||"",skills:e.skills||(null==n?void 0:n.skills)||[],profileCompleted:e.profileCompleted||(null==n?void 0:n.profile_completed)||!1,profileCompletion:e.profileCompletion||p({firstName:e.first_name||(null==n?void 0:n.first_name)||"",lastName:e.last_name||(null==n?void 0:n.last_name)||"",currentCompany:e.currentCompany||(null==n?void 0:n.company)||"",designation:e.designation||(null==n?void 0:n.current_position)||"",location:e.location||(null==n?void 0:n.location)||"",linkedinUrl:e.linkedinUrl||(null==n?void 0:n.linkedin_url)||"",githubUrl:e.githubUrl||(null==n?void 0:n.github_url)||"",bio:e.bio||(null==n?void 0:n.bio)||""}),avatarUrl:(null==n?void 0:n.avatar_path)||null,connections:0,profileViews:0,badges:[],createdAt:(null==n?void 0:n.created_at)||l.created_at,updatedAt:(null==n?void 0:n.updated_at)||new Date().toISOString()};console.log("UserContext: Merged profile:",t),v(t),U(null)}catch(e){console.error("UserContext: Error fetching profile:",e),U(e.message)}finally{b(!1)}}()},[l,u]);let y=async e=>{if(!l)throw Error("No user logged in");try{console.log("UserContext: Updating profile with:",e);let n=g||{};if(!Object.keys(e).some(l=>{let r=e[l],t=n[l];return"object"==typeof r&&"object"==typeof t?JSON.stringify(r)!==JSON.stringify(t):r!==t}))return console.log("UserContext: No changes detected, skipping update"),{success:!0};let{data:r,error:t}=await o.OQ.auth.updateUser({data:{...l.user_metadata,...e,updatedAt:new Date().toISOString()}});if(t)throw t;let{error:i}=await o.OQ.from("users").upsert({auth_id:l.id,email:l.email,first_name:e.firstName||(null==g?void 0:g.firstName)||null,last_name:e.lastName||(null==g?void 0:g.lastName)||null,usn:e.usn||(null==g?void 0:g.usn)||null,branch:e.branch||(null==g?void 0:g.branch)||null,admission_year:e.joiningYear||(null==g?void 0:g.joiningYear)||null,passing_year:e.passingYear||(null==g?void 0:g.passingYear)||null,company:e.currentCompany||(null==g?void 0:g.currentCompany)||null,current_position:e.designation||(null==g?void 0:g.designation)||null,location:e.location||(null==g?void 0:g.location)||null,linkedin_url:d(e.linkedinUrl)||d(null==g?void 0:g.linkedinUrl),github_url:s(e.githubUrl)||s(null==g?void 0:g.githubUrl),leetcode_url:c(e.leetcodeUrl)||c(null==g?void 0:g.leetcodeUrl),resume_url:e.resumeUrl&&e.resumeUrl.trim()?e.resumeUrl.trim():(null==g?void 0:g.resumeUrl)&&g.resumeUrl.trim()?g.resumeUrl.trim():null,bio:e.bio||(null==g?void 0:g.bio)||null,skills:e.skills||(null==g?void 0:g.skills)||null,profile_completed:!!(e.profileCompleted||(null==g?void 0:g.profileCompleted)),updated_at:new Date().toISOString()},{onConflict:"auth_id"});if(i)throw console.error("UserContext: Database update error:",i),Error(i.message||"Failed to update user profile in database");return v(n=>({...n,...e,updatedAt:new Date().toISOString()})),console.log("UserContext: Profile updated successfully"),{success:!0}}catch(e){throw console.error("UserContext: Update error:",e),e}},C=()=>{if(!g)return"User";let e=g.firstName||"",n=g.lastName||"";return"".concat(e," ").concat(n).trim()||(g.email?g.email.split("@")[0]:"User")},k={userProfile:g,loading:h,error:_,updateProfile:y,refreshProfile:async()=>{if(l&&u)try{console.log("UserContext: Refreshing profile data..."),b(!0);let{data:{user:e},error:n}=await o.OQ.auth.getUser();if(n||!e){console.error("UserContext: Error getting fresh user:",n);return}let l=e.user_metadata||{};console.log("UserContext: Fresh auth metadata:",l);let{data:r,error:t}=await m(e.id);t&&console.error("UserContext: Database error:",t);let i={id:e.id,email:e.email,firstName:l.first_name||(null==r?void 0:r.first_name)||"",lastName:l.last_name||(null==r?void 0:r.last_name)||"",usn:l.usn||(null==r?void 0:r.usn)||"",branch:l.branch||(null==r?void 0:r.branch)||"",branchCode:l.branch_code||(null==r?void 0:r.branch_code)||"",joiningYear:l.joining_year||(null==r?void 0:r.admission_year)||null,passingYear:l.passing_year||(null==r?void 0:r.passing_year)||null,currentCompany:l.currentCompany||(null==r?void 0:r.company)||"Not specified",designation:l.designation||(null==r?void 0:r.current_position)||"Not specified",location:l.location||(null==r?void 0:r.location)||"Not specified",linkedinUrl:l.linkedinUrl||(null==r?void 0:r.linkedin_url)||"",githubUrl:l.githubUrl||(null==r?void 0:r.github_url)||"",leetcodeUrl:l.leetcodeUrl||(null==r?void 0:r.leetcode_url)||"",resumeUrl:l.resumeUrl||(null==r?void 0:r.resume_url)||"",bio:l.bio||(null==r?void 0:r.bio)||"",skills:l.skills||(null==r?void 0:r.skills)||[],profileCompleted:l.profileCompleted||(null==r?void 0:r.profile_completed)||!1,profileCompletion:l.profileCompletion||p({firstName:l.first_name||(null==r?void 0:r.first_name)||"",lastName:l.last_name||(null==r?void 0:r.last_name)||"",currentCompany:l.currentCompany||(null==r?void 0:r.company)||"",designation:l.designation||(null==r?void 0:r.current_position)||"",location:l.location||(null==r?void 0:r.location)||"",linkedinUrl:l.linkedinUrl||(null==r?void 0:r.linkedin_url)||"",githubUrl:l.githubUrl||(null==r?void 0:r.github_url)||"",bio:l.bio||(null==r?void 0:r.bio)||""}),avatarUrl:(null==r?void 0:r.avatar_path)||null,connections:0,profileViews:0,badges:[],createdAt:(null==r?void 0:r.created_at)||e.created_at,updatedAt:(null==r?void 0:r.updated_at)||new Date().toISOString()};console.log("UserContext: Refreshed profile:",i),v(i),U(null)}catch(e){console.error("UserContext: Error refreshing profile:",e),U(e.message)}finally{b(!1)}},getFullName:C,getInitials:()=>C().split(" ").map(e=>e[0]).join("").toUpperCase().slice(0,2),isProfileComplete:(null==g?void 0:g.profileCompleted)||!1};return(0,r.jsx)(f.Provider,{value:k,children:n})}},7062:function(e,n,l){function r(){for(var e=arguments.length,n=Array(e),l=0;l<e;l++)n[l]=arguments[l];return n.filter(Boolean).join(" ")}function t(e,n){let l;return function(){for(var r=arguments.length,t=Array(r),i=0;i<r;i++)t[i]=arguments[i];clearTimeout(l),l=setTimeout(()=>{clearTimeout(l),e(...t)},n)}}function i(e){let n=["#4a90e2","#6366f1","#f59e0b","#52c41a","#ff4d4f"],l=e.split(" ").map(e=>e[0]).join("").toUpperCase().slice(0,2),r=e.length%n.length;return{initials:l,backgroundColor:n[r],textColor:"#ffffff"}}l.d(n,{Ds:function(){return t},El:function(){return i},cn:function(){return r}})}}]);