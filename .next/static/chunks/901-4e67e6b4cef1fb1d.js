"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[901],{2901:function(e,s,t){t.d(s,{Z:function(){return U}});var a=t(7437),i=t(2265),r=t(9376),l=t(6070),n=t(2869),o=t(5186),c=t(5900),d=t(9345),m=t(1883);function u(e){let{onStepChange:s}=e,{signInWithPassword:t,signInWithOTP:r,isReady:u}=(0,m.a)(),[h,x]=(0,i.useState)(""),[g,f]=(0,i.useState)(""),[p,b]=(0,i.useState)(""),[v,N]=(0,i.useState)(!1),[j,w]=(0,i.useState)(0),[y,D]=(0,i.useState)("password");(0,i.useEffect)(()=>{if(j>0){let e=setTimeout(()=>{w(e=>e-1)},1e3);return()=>clearTimeout(e)}},[j]);let E=(e,s)=>{"email"===e?x(s):"password"===e&&f(s),p&&b("")},S=()=>h.trim()?h.endsWith("@sit.ac.in")?/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(h)?!!("password"!==y||g.trim())||(b("Password is required"),!1):(b("Please enter a valid email address"),!1):(b("Please use your SIT institutional email (@sit.ac.in)"),!1):(b("Email is required"),!1),A=async e=>{if(e.preventDefault(),j>0){b("Please wait ".concat(j," seconds before trying again"));return}if(S()){N(!0),b("");try{var a,i,l,n,o;if(!u){b("Authentication service is not available. Please try again.");return}if("password"===y){console.log("Signing in with password for:",h);let{data:e,error:s}=await t(h.trim().toLowerCase(),g);if(s){console.error("Password login error:",s),"invalid_credentials"===s.code?b("Invalid email or password. If you signed up with OTP only, try 'Sign in with OTP'."):(null===(a=s.message)||void 0===a?void 0:a.includes("Email not confirmed"))?b("Please verify your email address first."):(null===(i=s.message)||void 0===i?void 0:i.includes("rate limit"))?(b("Too many attempts. Please wait before trying again."),w(60)):b(s.message||"Login failed");return}console.log("Password login successful, redirecting to dashboard...")}else{console.log("Sending login OTP to:",h);let{data:e,error:t}=await r(h.trim().toLowerCase());if(t){console.error("OTP login error:",t),(null===(l=t.message)||void 0===l?void 0:l.includes("not found"))||(null===(n=t.message)||void 0===n?void 0:n.includes("invalid"))?b("No account found with this email. Please sign up first."):(null===(o=t.message)||void 0===o?void 0:o.includes("rate limit"))?(b("Too many attempts. Please wait before trying again."),w(60)):b(t.message||"Failed to send verification code");return}console.log("Login OTP sent successfully:",e),sessionStorage.setItem("pendingVerificationEmail",h.trim().toLowerCase()),w(18),s("otp-verification",{email:h.trim().toLowerCase(),isSignUp:!1})}}catch(e){console.error("Unexpected error:",e),b("An unexpected error occurred. Please try again.")}finally{N(!1)}}};return(0,a.jsx)("div",{className:"flex items-center justify-center p-4 py-12",children:(0,a.jsxs)(l.Zb,{className:"w-full max-w-md bg-surface border-border shadow-2xl",children:[(0,a.jsxs)(l.Ol,{className:"text-center space-y-4",children:[(0,a.jsx)("div",{className:"mx-auto w-16 h-16 bg-[#4A90E2]/10 rounded-full flex items-center justify-center",children:(0,a.jsx)(c.Z,{className:"w-8 h-8 text-[#4A90E2]"})}),(0,a.jsx)(l.ll,{className:"text-2xl font-bold text-white",children:"Welcome Back"}),(0,a.jsx)(l.SZ,{className:"text-[#B0B0B0]",children:"Sign in to your AlumniVerse account"})]}),(0,a.jsxs)(l.aY,{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"flex bg-[#404040] rounded-lg p-1",children:[(0,a.jsx)("button",{type:"button",onClick:()=>D("password"),className:"flex-1 py-2 px-4 rounded-md text-sm font-medium transition-all ".concat("password"===y?"bg-[#4A90E2] text-white":"text-[#B0B0B0] hover:text-white"),children:"Password"}),(0,a.jsx)("button",{type:"button",onClick:()=>D("otp"),className:"flex-1 py-2 px-4 rounded-md text-sm font-medium transition-all ".concat("otp"===y?"bg-[#4A90E2] text-white":"text-[#B0B0B0] hover:text-white"),children:"OTP"})]}),(0,a.jsxs)("form",{onSubmit:A,className:"space-y-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("label",{className:"text-sm font-medium text-[#E0E0E0]",children:"SIT Email Address"}),(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)(d.Z,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-[#B0B0B0]"}),(0,a.jsx)(o.I,{type:"email",value:h,onChange:e=>E("email",e.target.value),className:"bg-[#404040] border-[#606060] text-white placeholder-[#B0B0B0] focus:border-[#4A90E2] pl-10",placeholder:"your.email@sit.ac.in",disabled:v})]})]}),"password"===y&&(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("label",{className:"text-sm font-medium text-[#E0E0E0]",children:"Password"}),(0,a.jsx)(o.I,{type:"password",value:g,onChange:e=>E("password",e.target.value),className:"bg-[#404040] border-[#606060] text-white placeholder-[#B0B0B0] focus:border-[#4A90E2]",placeholder:"Enter your password",disabled:v})]}),p&&(0,a.jsx)("p",{className:"text-red-400 text-sm",children:p}),(0,a.jsx)(n.z,{type:"submit",disabled:v||j>0,className:"w-full h-12 text-base font-semibold bg-[#4A90E2] hover:bg-[#4A90E2]/90 transition-all duration-200",children:v?(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("div",{className:"w-4 h-4 border-2 border-white/30 border-t-white rounded-full animate-spin"}),"password"===y?"Signing in...":"Sending code..."]}):j>0?"Wait ".concat(j,"s"):"password"===y?"Sign In":"Send Verification Code"})]}),(0,a.jsx)("div",{className:"bg-[#4A90E2]/10 border border-[#4A90E2]/30 rounded-lg p-4",children:(0,a.jsxs)("div",{className:"flex items-start gap-3",children:[(0,a.jsx)(d.Z,{className:"w-5 h-5 text-[#4A90E2] mt-0.5 flex-shrink-0"}),(0,a.jsxs)("div",{className:"space-y-1",children:[(0,a.jsx)("h4",{className:"text-sm font-medium text-[#4A90E2]",children:"password"===y?"Password Login":"OTP Login"}),(0,a.jsx)("p",{className:"text-xs text-[#B0B0B0]",children:"password"===y?"Sign in with the password you set during registration.":"We'll send a 6-digit verification code to your email."})]})]})}),(0,a.jsx)("div",{className:"text-center",children:(0,a.jsxs)("p",{className:"text-[#B0B0B0] text-sm",children:["Don't have an account?"," ",(0,a.jsx)("button",{onClick:()=>s("signup"),className:"text-[#4A90E2] hover:underline font-medium",disabled:v,children:"Sign up"})]})}),(0,a.jsx)("div",{className:"text-center",children:(0,a.jsx)("p",{className:"text-[#808080] text-xs",children:"Having trouble? Make sure you're using your SIT institutional email address."})})]})]})})}var h=t(7769),x=t(2208),g=t(8906),f=t(7030);function p(e){let{onStepChange:s}=e,{signUpWithOTP:t,signUpWithPassword:r,isReady:d,error:u}=(0,m.a)(),[p,b]=(0,i.useState)({firstName:"",lastName:"",email:"",password:"",confirmPassword:""}),[v,N]=(0,i.useState)(null),[j,w]=(0,i.useState)(!1),[y,D]=(0,i.useState)(!1),[E,S]=(0,i.useState)(!1),[A,B]=(0,i.useState)({}),[C,P]=(0,i.useState)(!1),[I,k]=(0,i.useState)(0);(0,i.useEffect)(()=>{if(I>0){let e=setTimeout(()=>{k(e=>e-1)},1e3);return()=>clearTimeout(e)}},[I]),(0,i.useEffect)(()=>{let e=(p.email||"").trim().toLowerCase();if(!e){N(null);return}let s=setTimeout(()=>{if(e.endsWith("@sit.ac.in")){let s=(0,f.zA)(e);(null==s?void 0:s.isValid)?(N(s),B(e=>({...e,email:""}))):j&&(N(null),B(e=>({...e,email:(null==s?void 0:s.error)||"Invalid institutional email"})))}else j&&(N(null),B(e=>({...e,email:"Please use your SIT institutional email (@sit.ac.in)"})))},350);return()=>clearTimeout(s)},[p.email,j]);let T=(e,s)=>{b(t=>({...t,[e]:s})),A[e]&&B(s=>({...s,[e]:""}))},_=()=>{let e={};return p.firstName.trim()||(e.firstName="First name is required"),p.lastName.trim()||(e.lastName="Last name is required"),p.email.trim()||(e.email="Email is required"),p.email&&!p.email.endsWith("@sit.ac.in")&&(e.email="Please use your SIT institutional email (@sit.ac.in)"),p.email.endsWith("@sit.ac.in")&&!v&&(e.email="Invalid SIT email format. Please use format: 1si23cs001@sit.ac.in"),p.password?p.password.length<8&&(e.password="Password must be at least 8 characters"):e.password="Password is required",p.confirmPassword?p.password!==p.confirmPassword&&(e.confirmPassword="Passwords do not match"):e.confirmPassword="Please confirm your password",B(e),0===Object.keys(e).length},U=async e=>{if(e.preventDefault(),I>0){B({submit:"Please wait ".concat(I," seconds before trying again")});return}if(_()){P(!0),B({});try{let e={first_name:p.firstName.trim(),last_name:p.lastName.trim(),usn:(null==v?void 0:v.usn)||"",branch:(null==v?void 0:v.branch)||"",joining_year:(null==v?void 0:v.joiningYear)||null,passing_year:(null==v?void 0:v.passingYear)||null,branch_code:(null==v?void 0:v.branchCode)||""};if(console.log("Sending OTP with metadata:",e),!d){B({submit:"Authentication service is not available. Please try again."});return}let{data:l,error:n}=await r(p.email.trim().toLowerCase(),p.password,e);if(n){var a,i;console.error("Signup error:",n),(null===(a=n.message)||void 0===a?void 0:a.includes("already registered"))||(null===(i=n.message)||void 0===i?void 0:i.includes("User already registered"))?B({email:"This email is already registered. Please use the 'Sign In' option instead."}):429===n.status||/rate limit|Too Many Requests/i.test(n.message||"")?(B({submit:"Too many attempts. Please wait before trying again."}),k(60)):B({submit:n.message||"Failed to create account"});return}console.log("Account created successfully, sending OTP..."),await t(p.email.trim().toLowerCase(),e),sessionStorage.setItem("pendingVerificationEmail",p.email.trim().toLowerCase()),sessionStorage.setItem("pendingFirstName",p.firstName.trim()),sessionStorage.setItem("pendingLastName",p.lastName.trim()),v&&(sessionStorage.setItem("pendingUSN",v.usn||""),sessionStorage.setItem("pendingBranch",v.branch||""),sessionStorage.setItem("pendingJoiningYear",v.joiningYear||""),sessionStorage.setItem("pendingPassingYear",v.passingYear||"")),k(18),s("otp-verification",{email:p.email.trim().toLowerCase(),firstName:p.firstName.trim(),lastName:p.lastName.trim(),isSignUp:!0,userData:e})}catch(e){e&&(e.message||e.code||Object.keys(e).length>0)&&console.error("Unexpected error:",e),B({submit:"An unexpected error occurred. Please try again."})}finally{P(!1)}}};return(0,a.jsx)("div",{className:"flex items-center justify-center p-4 py-12",children:(0,a.jsxs)(l.Zb,{className:"w-full max-w-md bg-surface border-border shadow-2xl",children:[(0,a.jsxs)(l.Ol,{className:"text-center space-y-4",children:[(0,a.jsx)("div",{className:"mx-auto w-16 h-16 bg-[#4A90E2]/10 rounded-full flex items-center justify-center",children:(0,a.jsx)(c.Z,{className:"w-8 h-8 text-[#4A90E2]"})}),(0,a.jsx)(l.ll,{className:"text-2xl font-bold text-white",children:"Join AlumniVerse"}),(0,a.jsx)(l.SZ,{className:"text-[#B0B0B0]",children:"Connect with your SIT alumni network"})]}),(0,a.jsxs)(l.aY,{className:"space-y-6",children:[(0,a.jsxs)("form",{onSubmit:U,className:"space-y-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("label",{className:"text-sm font-medium text-[#E0E0E0]",children:"First Name"}),(0,a.jsx)(o.I,{type:"text",value:p.firstName,onChange:e=>T("firstName",e.target.value),className:"bg-[#404040] border-[#606060] text-white placeholder-[#B0B0B0] focus:border-[#4A90E2]",placeholder:"Enter your first name",disabled:C}),A.firstName&&(0,a.jsx)("p",{className:"text-red-400 text-sm",children:A.firstName})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("label",{className:"text-sm font-medium text-[#E0E0E0]",children:"Last Name"}),(0,a.jsx)(o.I,{type:"text",value:p.lastName,onChange:e=>T("lastName",e.target.value),className:"bg-[#404040] border-[#606060] text-white placeholder-[#B0B0B0] focus:border-[#4A90E2]",placeholder:"Enter your last name",disabled:C}),A.lastName&&(0,a.jsx)("p",{className:"text-red-400 text-sm",children:A.lastName})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("label",{className:"text-sm font-medium text-[#E0E0E0]",children:"SIT Email Address"}),(0,a.jsx)(o.I,{type:"email",value:p.email,onChange:e=>T("email",e.target.value),onBlur:()=>{w(!0);let e=(p.email||"").trim().toLowerCase();if(e){if(e.endsWith("@sit.ac.in")){let s=(0,f.zA)(e);(null==s?void 0:s.isValid)?(N(s),B(e=>({...e,email:""}))):(N(null),B(e=>({...e,email:(null==s?void 0:s.error)||"Invalid institutional email"})))}else N(null),B(e=>({...e,email:"Please use your SIT institutional email (@sit.ac.in)"}))}},className:"bg-[#404040] border-[#606060] text-white placeholder-[#B0B0B0] focus:border-[#4A90E2]",placeholder:"1si23cs001@sit.ac.in",disabled:C}),A.email&&(0,a.jsx)("p",{className:"text-red-400 text-sm",children:A.email})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("label",{className:"text-sm font-medium text-[#E0E0E0]",children:"Password"}),(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)(o.I,{type:y?"text":"password",value:p.password,onChange:e=>T("password",e.target.value),className:"bg-[#404040] border-[#606060] text-white placeholder-[#B0B0B0] focus:border-[#4A90E2] pr-10",placeholder:"Create a strong password",disabled:C}),(0,a.jsx)("button",{type:"button",onClick:()=>D(!y),className:"absolute right-3 top-1/2 -translate-y-1/2 text-[#B0B0B0] hover:text-white",children:y?(0,a.jsx)(h.Z,{className:"w-4 h-4"}):(0,a.jsx)(x.Z,{className:"w-4 h-4"})})]}),A.password&&(0,a.jsx)("p",{className:"text-red-400 text-sm",children:A.password})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("label",{className:"text-sm font-medium text-[#E0E0E0]",children:"Confirm Password"}),(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)(o.I,{type:E?"text":"password",value:p.confirmPassword,onChange:e=>T("confirmPassword",e.target.value),className:"bg-[#404040] border-[#606060] text-white placeholder-[#B0B0B0] focus:border-[#4A90E2] pr-10",placeholder:"Confirm your password",disabled:C}),(0,a.jsx)("button",{type:"button",onClick:()=>S(!E),className:"absolute right-3 top-1/2 -translate-y-1/2 text-[#B0B0B0] hover:text-white",children:E?(0,a.jsx)(h.Z,{className:"w-4 h-4"}):(0,a.jsx)(x.Z,{className:"w-4 h-4"})})]}),A.confirmPassword&&(0,a.jsx)("p",{className:"text-red-400 text-sm",children:A.confirmPassword})]}),v&&(0,a.jsxs)("div",{className:"bg-[#4A90E2]/10 border border-[#4A90E2]/30 rounded-lg p-4 space-y-2",children:[(0,a.jsx)("h4",{className:"text-sm font-medium text-[#4A90E2]",children:"Detected Information:"}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-2 text-sm text-[#E0E0E0]",children:[(0,a.jsxs)("div",{children:["USN: ",(0,a.jsx)("span",{className:"text-[#4A90E2]",children:v.usn})]}),(0,a.jsxs)("div",{children:["Branch: ",(0,a.jsx)("span",{className:"text-[#4A90E2]",children:v.branch})]}),(0,a.jsxs)("div",{children:["Joining: ",(0,a.jsx)("span",{className:"text-[#4A90E2]",children:v.joiningYear})]}),(0,a.jsxs)("div",{children:["Passing: ",(0,a.jsx)("span",{className:"text-[#4A90E2]",children:v.passingYear})]})]})]}),(0,a.jsxs)("div",{className:"bg-[#4A90E2]/10 border border-[#4A90E2]/30 rounded-lg p-4 flex items-start space-x-3",children:[(0,a.jsx)(g.Z,{className:"w-5 h-5 text-[#4A90E2] mt-0.5 flex-shrink-0"}),(0,a.jsxs)("div",{className:"space-y-1",children:[(0,a.jsx)("h4",{className:"text-sm font-medium text-[#4A90E2]",children:"Email Verification Required"}),(0,a.jsx)("p",{className:"text-xs text-[#B0B0B0]",children:"After creating your account, we'll send a verification code to your email to confirm your identity."})]})]}),(0,a.jsx)(n.z,{type:"submit",disabled:C||I>0,className:"w-full h-12 text-base font-semibold bg-[#4A90E2] hover:bg-[#4A90E2]/90 transition-all duration-200",children:C?(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("div",{className:"w-4 h-4 border-2 border-white/30 border-t-white rounded-full animate-spin"}),"Creating account..."]}):I>0?"Wait ".concat(I,"s"):"Create Account"}),A.submit&&(0,a.jsx)("div",{className:"bg-red-500/10 border border-red-500/30 rounded-lg p-3",children:(0,a.jsx)("p",{className:"text-red-400 text-sm",children:A.submit})})]}),(0,a.jsx)("div",{className:"text-center",children:(0,a.jsxs)("p",{className:"text-[#B0B0B0] text-sm",children:["Already have an account?"," ",(0,a.jsx)("button",{onClick:()=>s("signin"),className:"text-[#4A90E2] hover:underline font-medium",disabled:C,children:"Sign in"})]})})]})]})})}var b=t(1671),v=t(2660),N=t(5153);function j(e){let{email:s,firstName:t,lastName:c,isSignUp:u=!1,userData:h={},onStepChange:x}=e,g=(0,r.useRouter)(),{verifyOTP:f,signUpWithOTP:p,signInWithOTP:j,isReady:w}=(0,m.a)(),{toast:y}=(0,N.pm)(),[D,E]=(0,i.useState)(["","","","","",""]),[S,A]=(0,i.useState)(!1),[B,C]=(0,i.useState)(!1),[P,I]=(0,i.useState)(60),[k,T]=(0,i.useState)(!1),[_,U]=(0,i.useState)(""),[F,O]=(0,i.useState)(""),[Y,Z]=(0,i.useState)(0),[L,R]=(0,i.useState)(0),z=(0,i.useRef)([]);(0,i.useEffect)(()=>{if(P>0){let e=setTimeout(()=>I(P-1),1e3);return()=>clearTimeout(e)}T(!0)},[P]),(0,i.useEffect)(()=>{if(L>0){let e=setTimeout(()=>R(L-1),1e3);return()=>clearTimeout(e)}},[L]),(0,i.useEffect)(()=>{var e;null===(e=z.current[0])||void 0===e||e.focus()},[]);let V=(e,s)=>{if(!/^\d*$/.test(s))return;let t=[...D];if(t[e]=s,E(t),U(""),s&&e<5){var a;null===(a=z.current[e+1])||void 0===a||a.focus()}},M=(e,s)=>{if("Backspace"===s.key&&!D[e]&&e>0){var t;null===(t=z.current[e-1])||void 0===t||t.focus();return}"v"===s.key&&(s.ctrlKey||s.metaKey)&&(s.preventDefault(),navigator.clipboard.readText().then(e=>{let s=e.replace(/\D/g,"").slice(0,6);if(6===s.length){var t;E(s.split("")),null===(t=z.current[5])||void 0===t||t.focus()}}))},W=async()=>{var e,a;let i=D.join("");if(6!==i.length){U("Please enter the complete 6-digit code");return}if(Y>=3){U("Too many attempts. Please wait before trying again."),R(30);return}A(!0),U("");try{if(console.log("Verifying OTP via Supabase:",{email:s}),!w){U("Authentication service is not available. Please try again.");return}let{data:a,error:r}=await f(s,i,{first_name:t,last_name:c,usn:null==h?void 0:h.usn,branch:null==h?void 0:h.branch,branch_code:null==h?void 0:h.branch_code,admission_year:null==h?void 0:h.joining_year,passing_year:null==h?void 0:h.passing_year});!r&&a&&a.user?(O("✅ Email verified successfully!"),y({title:"Verification Successful! \uD83C\uDF89",description:"Your email has been verified. Redirecting...",variant:"default"}),setTimeout(()=>{console.log("OTP verification successful"),sessionStorage.removeItem("pendingVerificationEmail"),sessionStorage.removeItem("pendingFirstName"),sessionStorage.removeItem("pendingLastName"),sessionStorage.removeItem("pendingUSN"),sessionStorage.removeItem("pendingBranch"),sessionStorage.removeItem("pendingJoiningYear"),sessionStorage.removeItem("pendingPassingYear"),window.location.href="/dashboard"},1500)):(Z(e=>e+1),U((null==r?void 0:r.message)||"Verification failed. Please check your code and try again."),E(["","","","","",""]),null===(e=z.current[0])||void 0===e||e.focus())}catch(e){console.error("OTP verification error:",e),Z(e=>e+1),U("Verification failed. Please try again."),E(["","","","","",""]),null===(a=z.current[0])||void 0===a||a.focus()}finally{A(!1)}},q=async()=>{if(k&&!B){C(!0),U("");try{if(!w){U("Authentication service is not available. Please try again.");return}let{data:e,error:t}=u?await p(s,h):await j(s);!t&&e?(O("✅ New code sent to your email!"),I(60),T(!1),Z(0),setTimeout(()=>O(""),3e3)):U((null==t?void 0:t.message)||"Failed to resend code. Please try again.")}catch(e){console.error("Resend OTP error:",e),U("Failed to resend code. Please try again.")}finally{C(!1)}}};return(0,a.jsx)("div",{className:"flex items-center justify-center p-4 py-12",children:(0,a.jsxs)(l.Zb,{className:"w-full max-w-md bg-surface border-border",children:[(0,a.jsxs)(l.Ol,{className:"text-center space-y-2",children:[(0,a.jsx)("div",{className:"mx-auto w-12 h-12 bg-[#4A90E2]/20 rounded-full flex items-center justify-center mb-4",children:(0,a.jsx)(d.Z,{className:"w-6 h-6 text-[#4A90E2]"})}),(0,a.jsx)(l.ll,{className:"text-2xl font-bold text-white",children:"Verify Your Email"}),(0,a.jsxs)(l.SZ,{className:"text-[#B0B0B0]",children:["We've sent a 6-digit code to",(0,a.jsx)("br",{}),(0,a.jsx)("span",{className:"font-medium text-[#4A90E2]",children:s})]})]}),(0,a.jsxs)(l.aY,{className:"space-y-6",children:[(0,a.jsx)("div",{className:"flex justify-center space-x-3",children:D.map((e,s)=>(0,a.jsx)(o.I,{ref:e=>z.current[s]=e,type:"text",inputMode:"numeric",maxLength:1,value:e,onChange:e=>V(s,e.target.value),onKeyDown:e=>M(s,e),className:"w-12 h-12 text-center text-xl font-bold bg-[#1A1A1A] border-[#404040] text-white focus:border-[#4A90E2] focus:ring-[#4A90E2]/20",disabled:S},s))}),_&&(0,a.jsx)("div",{className:"text-red-400 text-sm text-center bg-red-400/10 border border-red-400/20 rounded-lg p-3",children:_}),F&&(0,a.jsxs)("div",{className:"text-green-400 text-sm text-center bg-green-400/10 border border-green-400/20 rounded-lg p-3 flex items-center justify-center space-x-2",children:[(0,a.jsx)(b.Z,{className:"w-4 h-4"}),(0,a.jsx)("span",{children:F})]}),(0,a.jsx)(n.z,{onClick:W,disabled:S||6!==D.join("").length||L>0,className:"w-full bg-[#4A90E2] hover:bg-[#357ABD] text-white font-medium py-3 disabled:opacity-50 disabled:cursor-not-allowed",children:S?(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)("div",{className:"w-4 h-4 border-2 border-white/30 border-t-white rounded-full animate-spin"}),(0,a.jsx)("span",{children:"Verifying..."})]}):L>0?"Wait ".concat(L,"s"):"Verify Email"}),(0,a.jsxs)("div",{className:"text-center space-y-2",children:[(0,a.jsx)("p",{className:"text-[#B0B0B0] text-sm",children:"Didn't receive the code?"}),(0,a.jsx)(n.z,{variant:"ghost",onClick:q,disabled:!k||B,className:"text-[#4A90E2] hover:text-[#357ABD] hover:bg-[#4A90E2]/10 font-medium",children:B?(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)("div",{className:"w-4 h-4 border-2 border-[#4A90E2]/30 border-t-[#4A90E2] rounded-full animate-spin"}),(0,a.jsx)("span",{children:"Sending..."})]}):k?"Resend Code":"Resend in ".concat(P,"s")})]}),(0,a.jsxs)(n.z,{variant:"ghost",onClick:()=>{x?x("login"):g.push("/login")},className:"w-full text-[#B0B0B0] hover:text-white hover:bg-[#404040] flex items-center justify-center space-x-2",children:[(0,a.jsx)(v.Z,{className:"w-4 h-4"}),(0,a.jsx)("span",{children:"Back to Login"})]})]})]})})}var w=t(6815),y=t(6818),D=t(2759),E=t(2369),S=t(5005),A=t(3327),B=t(401),C=t(7689),P=t(6858);let I=[{id:1,title:"Basic Information",icon:E.Z},{id:2,title:"Professional Details",icon:S.Z},{id:3,title:"Additional Information",icon:A.Z}];function k(e){let{userData:s,onComplete:t}=e,{user:r}=(0,m.a)(),[c,d]=(0,i.useState)(1),[u,h]=(0,i.useState)(!1),[x,g]=(0,i.useState)({}),[p,b]=(0,i.useState)({firstName:"",lastName:"",email:"",branch:"",joiningYear:"",passingYear:"",usn:"",currentCompany:"",designation:"",location:"",linkedinUrl:"",githubUrl:"",leetcodeUrl:"",resumeFile:null,resumeUrl:"",skills:"",bio:"",achievements:"",interests:"",mentorshipAvailable:!1,jobReferralsAvailable:!1});(0,i.useEffect)(()=>{if((null==s?void 0:s.email)||(null==r?void 0:r.email)){var e,t;let a=(null==s?void 0:s.email)||(null==r?void 0:r.email),i=(0,f.zA)(a),l=(null==s?void 0:s.firstName)||(null==s?void 0:null===(e=s.userData)||void 0===e?void 0:e.first_name)||"",n=(null==s?void 0:s.lastName)||(null==s?void 0:null===(t=s.userData)||void 0===t?void 0:t.last_name)||"";i.isValid?b(e=>({...e,email:a,firstName:l,lastName:n,branch:i.branch,joiningYear:i.joiningYear,passingYear:i.passingYear,usn:i.usn})):b(e=>({...e,email:a,firstName:l,lastName:n}))}},[s,r]);let N=(e,s)=>{b(t=>({...t,[e]:s})),x[e]&&g(s=>({...s,[e]:""}))},j=e=>{let s={};switch(e){case 1:p.firstName.trim()||(s.firstName="First name is required"),p.lastName.trim()||(s.lastName="Last name is required"),p.email.trim()||(s.email="Email is required"),p.branch.trim()||(s.branch="Branch is required"),p.passingYear||(s.passingYear="Passing year is required");break;case 2:p.linkedinUrl&&!p.linkedinUrl.includes("linkedin.com")&&(s.linkedinUrl="Please enter a valid LinkedIn URL"),p.githubUrl&&!p.githubUrl.includes("github.com")&&(s.githubUrl="Please enter a valid GitHub URL"),p.leetcodeUrl&&!p.leetcodeUrl.includes("leetcode.com")&&(s.leetcodeUrl="Please enter a valid LeetCode URL")}return g(s),0===Object.keys(s).length},E=async()=>{if(j(c)){h(!0);try{let e=await fetch("/api/profile/create",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({auth_id:null==r?void 0:r.id,email:p.email,first_name:p.firstName,last_name:p.lastName,usn:p.usn,branch:p.branch,admission_year:p.joiningYear,passing_year:p.passingYear,company:p.currentCompany,current_position:p.designation,location:p.location,linkedin_url:p.linkedinUrl,github_url:p.githubUrl,bio:p.bio,skills:p.skills,profile_completed:!0})}),s=await e.json();if(!e.ok)throw Error(s.error||"Failed to create profile");console.log("Profile created successfully via API:",s);let a=s.data||p;t(a)}catch(e){console.error("Profile creation failed:",e),g({submit:e.message||"Failed to create profile. Please try again."})}finally{h(!1)}}},S=c/I.length*100;return(0,a.jsx)("div",{className:"min-h-screen bg-[#1A1A1A] flex items-center justify-center p-4",children:(0,a.jsxs)(l.Zb,{className:"w-full max-w-2xl bg-[#2D2D2D] border-[#3D3D3D]",children:[(0,a.jsxs)(l.Ol,{className:"text-center",children:[(0,a.jsx)(l.ll,{className:"text-2xl font-bold text-white mb-2",children:"Complete Your Profile"}),(0,a.jsxs)(l.SZ,{className:"text-[#B0B0B0]",children:["Step ",c," of ",I.length,": ",I[c-1].title]}),(0,a.jsxs)("div",{className:"mt-4",children:[(0,a.jsx)(D.E,{value:S,className:"h-2 bg-[#3D3D3D]"}),(0,a.jsx)("div",{className:"flex justify-between mt-2",children:I.map((e,s)=>{let t=e.icon,i=c>e.id,r=c===e.id;return(0,a.jsxs)("div",{className:"flex flex-col items-center",children:[(0,a.jsx)("div",{className:"w-8 h-8 rounded-full flex items-center justify-center text-sm font-medium ".concat(i?"bg-[#4A90E2] text-white":r?"bg-[#4A90E2]/20 text-[#4A90E2] border-2 border-[#4A90E2]":"bg-[#3D3D3D] text-[#B0B0B0]"),children:i?(0,a.jsx)(B.Z,{className:"w-4 h-4"}):(0,a.jsx)(t,{className:"w-4 h-4"})}),(0,a.jsx)("span",{className:"text-xs mt-1 ".concat(r?"text-[#4A90E2]":"text-[#B0B0B0]"),children:e.title})]},e.id)})})]})]}),(0,a.jsxs)(l.aY,{className:"space-y-6",children:[1===c&&(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)(w._,{htmlFor:"firstName",className:"text-white",children:"First Name *"}),(0,a.jsx)(o.I,{id:"firstName",value:p.firstName,onChange:e=>N("firstName",e.target.value),className:"bg-[#3D3D3D] border-[#4D4D4D] text-white",placeholder:"Enter your first name"}),x.firstName&&(0,a.jsx)("p",{className:"text-red-400 text-sm mt-1",children:x.firstName})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(w._,{htmlFor:"lastName",className:"text-white",children:"Last Name *"}),(0,a.jsx)(o.I,{id:"lastName",value:p.lastName,onChange:e=>N("lastName",e.target.value),className:"bg-[#3D3D3D] border-[#4D4D4D] text-white",placeholder:"Enter your last name"}),x.lastName&&(0,a.jsx)("p",{className:"text-red-400 text-sm mt-1",children:x.lastName})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(w._,{htmlFor:"email",className:"text-white",children:"Email *"}),(0,a.jsx)(o.I,{id:"email",type:"email",value:p.email,onChange:e=>N("email",e.target.value),className:"bg-[#3D3D3D] border-[#4D4D4D] text-white",placeholder:"your.email@sit.ac.in",disabled:!0}),x.email&&(0,a.jsx)("p",{className:"text-red-400 text-sm mt-1",children:x.email})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)(w._,{htmlFor:"branch",className:"text-white",children:["Branch * ",(0,a.jsx)("span",{className:"text-xs text-[#B0B0B0]",children:"(Auto-extracted from email)"})]}),(0,a.jsx)(o.I,{id:"branch",value:p.branch,onChange:e=>N("branch",e.target.value),className:"bg-[#2D2D2D] border-[#4D4D4D] text-white cursor-not-allowed opacity-75",placeholder:"Computer Science",disabled:!0,readOnly:!0}),x.branch&&(0,a.jsx)("p",{className:"text-red-400 text-sm mt-1",children:x.branch})]}),(0,a.jsxs)("div",{children:[(0,a.jsxs)(w._,{htmlFor:"passingYear",className:"text-white",children:["Passing Year * ",(0,a.jsx)("span",{className:"text-xs text-[#B0B0B0]",children:"(Auto-extracted from email)"})]}),(0,a.jsx)(o.I,{id:"passingYear",type:"number",value:p.passingYear,onChange:e=>N("passingYear",parseInt(e.target.value)),className:"bg-[#2D2D2D] border-[#4D4D4D] text-white cursor-not-allowed opacity-75",placeholder:"2024",min:"2000",max:"2030",disabled:!0,readOnly:!0}),x.passingYear&&(0,a.jsx)("p",{className:"text-red-400 text-sm mt-1",children:x.passingYear})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsxs)(w._,{htmlFor:"usn",className:"text-white",children:["USN ",(0,a.jsx)("span",{className:"text-xs text-[#B0B0B0]",children:"(Auto-extracted from email)"})]}),(0,a.jsx)(o.I,{id:"usn",value:p.usn,onChange:e=>N("usn",e.target.value.toUpperCase()),className:"bg-[#2D2D2D] border-[#4D4D4D] text-white cursor-not-allowed opacity-75",placeholder:"1SI23IS117",disabled:!0,readOnly:!0})]})]}),2===c&&(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)(w._,{htmlFor:"currentCompany",className:"text-white",children:"Current Company"}),(0,a.jsx)(o.I,{id:"currentCompany",value:p.currentCompany,onChange:e=>N("currentCompany",e.target.value),className:"bg-[#3D3D3D] border-[#4D4D4D] text-white",placeholder:"Google, Microsoft, etc."})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(w._,{htmlFor:"designation",className:"text-white",children:"Designation"}),(0,a.jsx)(o.I,{id:"designation",value:p.designation,onChange:e=>N("designation",e.target.value),className:"bg-[#3D3D3D] border-[#4D4D4D] text-white",placeholder:"Software Engineer, etc."})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(w._,{htmlFor:"location",className:"text-white",children:"Location"}),(0,a.jsx)(o.I,{id:"location",value:p.location,onChange:e=>N("location",e.target.value),className:"bg-[#3D3D3D] border-[#4D4D4D] text-white",placeholder:"Bangalore, India"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(w._,{className:"text-white",children:"Resume Upload"}),(0,a.jsxs)("div",{className:"mt-2 border-2 border-dashed border-[#4D4D4D] rounded-lg p-6 text-center hover:border-[#4A90E2] transition-colors",children:[(0,a.jsx)(C.Z,{className:"w-8 h-8 text-[#B0B0B0] mx-auto mb-2"}),(0,a.jsx)("p",{className:"text-[#B0B0B0] mb-2",children:"Drag and drop your resume here, or click to browse"}),(0,a.jsx)("input",{type:"file",accept:".pdf",onChange:e=>{let s=e.target.files[0];if(s){if(s.size>5242880){g(e=>({...e,resumeFile:"File size must be less than 5MB"}));return}if(!s.type.includes("pdf")){g(e=>({...e,resumeFile:"Please upload a PDF file"}));return}b(e=>({...e,resumeFile:s})),g(e=>({...e,resumeFile:""}))}},className:"hidden",id:"resume-upload"}),(0,a.jsx)(n.z,{type:"button",variant:"outline",onClick:()=>document.getElementById("resume-upload").click(),className:"bg-transparent border-[#4D4D4D] text-white hover:bg-[#3D3D3D]",children:"Choose File"}),p.resumeFile&&(0,a.jsxs)("p",{className:"text-[#4A90E2] mt-2",children:["✓ ",p.resumeFile.name]}),x.resumeFile&&(0,a.jsx)("p",{className:"text-red-400 text-sm mt-1",children:x.resumeFile})]})]}),(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsx)(w._,{className:"text-white",children:"Professional Links"}),(0,a.jsxs)("div",{children:[(0,a.jsx)(o.I,{value:p.linkedinUrl,onChange:e=>N("linkedinUrl",e.target.value),className:"bg-[#3D3D3D] border-[#4D4D4D] text-white",placeholder:"https://linkedin.com/in/yourprofile"}),x.linkedinUrl&&(0,a.jsx)("p",{className:"text-red-400 text-sm mt-1",children:x.linkedinUrl})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(o.I,{value:p.githubUrl,onChange:e=>N("githubUrl",e.target.value),className:"bg-[#3D3D3D] border-[#4D4D4D] text-white",placeholder:"https://github.com/yourusername"}),x.githubUrl&&(0,a.jsx)("p",{className:"text-red-400 text-sm mt-1",children:x.githubUrl})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(o.I,{value:p.leetcodeUrl,onChange:e=>N("leetcodeUrl",e.target.value),className:"bg-[#3D3D3D] border-[#4D4D4D] text-white",placeholder:"https://leetcode.com/yourusername"}),x.leetcodeUrl&&(0,a.jsx)("p",{className:"text-red-400 text-sm mt-1",children:x.leetcodeUrl})]})]})]}),3===c&&(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)(w._,{htmlFor:"skills",className:"text-white",children:"Skills & Technologies"}),(0,a.jsx)(y.g,{id:"skills",value:p.skills,onChange:e=>N("skills",e.target.value),className:"bg-[#3D3D3D] border-[#4D4D4D] text-white",placeholder:"React, Node.js, Python, Machine Learning, etc.",rows:3})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(w._,{htmlFor:"bio",className:"text-white",children:"Bio"}),(0,a.jsx)(y.g,{id:"bio",value:p.bio,onChange:e=>N("bio",e.target.value),className:"bg-[#3D3D3D] border-[#4D4D4D] text-white",placeholder:"Tell us about yourself...",rows:4})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(w._,{htmlFor:"achievements",className:"text-white",children:"Achievements & Awards"}),(0,a.jsx)(y.g,{id:"achievements",value:p.achievements,onChange:e=>N("achievements",e.target.value),className:"bg-[#3D3D3D] border-[#4D4D4D] text-white",placeholder:"Hackathon wins, certifications, publications, etc.",rows:3})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(w._,{htmlFor:"interests",className:"text-white",children:"Interests & Hobbies"}),(0,a.jsx)(y.g,{id:"interests",value:p.interests,onChange:e=>N("interests",e.target.value),className:"bg-[#3D3D3D] border-[#4D4D4D] text-white",placeholder:"Photography, traveling, open source, etc.",rows:2})]}),(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsx)(w._,{className:"text-white",children:"Community Participation"}),(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)("input",{type:"checkbox",id:"mentorshipAvailable",checked:p.mentorshipAvailable,onChange:e=>N("mentorshipAvailable",e.target.checked),className:"w-4 h-4 text-[#4A90E2] bg-[#3D3D3D] border-[#4D4D4D] rounded focus:ring-[#4A90E2]"}),(0,a.jsx)(w._,{htmlFor:"mentorshipAvailable",className:"text-white",children:"Available for mentorship"})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)("input",{type:"checkbox",id:"jobReferralsAvailable",checked:p.jobReferralsAvailable,onChange:e=>N("jobReferralsAvailable",e.target.checked),className:"w-4 h-4 text-[#4A90E2] bg-[#3D3D3D] border-[#4D4D4D] rounded focus:ring-[#4A90E2]"}),(0,a.jsx)(w._,{htmlFor:"jobReferralsAvailable",className:"text-white",children:"Available for job referrals"})]})]})]}),(0,a.jsxs)("div",{className:"flex justify-between pt-6",children:[(0,a.jsxs)(n.z,{variant:"outline",onClick:()=>{d(e=>Math.max(e-1,1))},disabled:1===c,className:"bg-transparent border-[#4D4D4D] text-white hover:bg-[#3D3D3D]",children:[(0,a.jsx)(v.Z,{className:"w-4 h-4 mr-2"}),"Previous"]}),c<I.length?(0,a.jsxs)(n.z,{onClick:()=>{j(c)&&d(e=>Math.min(e+1,I.length))},className:"bg-[#4A90E2] hover:bg-[#357ABD] text-white",children:["Next",(0,a.jsx)(P.Z,{className:"w-4 h-4 ml-2"})]}):(0,a.jsx)(n.z,{onClick:E,disabled:u,className:"bg-[#4A90E2] hover:bg-[#357ABD] text-white",children:u?"Creating Profile...":"Complete Profile"})]}),x.submit&&(0,a.jsx)("p",{className:"text-red-400 text-sm text-center",children:x.submit})]})]})})}function T(e){let{onStepChange:s,initialEmail:t=""}=e,{resetPassword:r,isReady:u}=(0,m.a)(),[h,x]=(0,i.useState)(t),[g,f]=(0,i.useState)(""),[p,b]=(0,i.useState)(!1),[N,j]=(0,i.useState)(!1),w=()=>h.trim()?h.endsWith("@sit.ac.in")?!!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(h)||(f("Please enter a valid email address"),!1):(f("Please use your SIT institutional email (@sit.ac.in)"),!1):(f("Email is required"),!1),y=async e=>{if(e.preventDefault(),w()){b(!0),f("");try{if(!u){f("Authentication service is not available. Please try again.");return}let{data:e,error:s}=await r(h.trim().toLowerCase());if(s){console.error("Reset password error:",s),f(s.message||"Failed to send reset email");return}console.log("Reset password email sent:",e),j(!0)}catch(e){console.error("Unexpected error:",e),f("An unexpected error occurred. Please try again.")}finally{b(!1)}}};return N?(0,a.jsx)("div",{className:"flex items-center justify-center p-4 py-12",children:(0,a.jsxs)(l.Zb,{className:"w-full max-w-md bg-surface border-border shadow-2xl",children:[(0,a.jsxs)(l.Ol,{className:"text-center space-y-4",children:[(0,a.jsx)("div",{className:"mx-auto w-16 h-16 bg-green-500/10 rounded-full flex items-center justify-center",children:(0,a.jsx)(d.Z,{className:"w-8 h-8 text-green-500"})}),(0,a.jsx)(l.ll,{className:"text-2xl font-bold text-white",children:"Check Your Email"}),(0,a.jsxs)(l.SZ,{className:"text-[#B0B0B0]",children:["We've sent password reset instructions to ",(0,a.jsx)("strong",{className:"text-white",children:h})]})]}),(0,a.jsxs)(l.aY,{className:"space-y-6",children:[(0,a.jsx)("div",{className:"bg-green-500/10 border border-green-500/30 rounded-lg p-4",children:(0,a.jsx)("p",{className:"text-sm text-[#B0B0B0] text-center",children:"Please check your email and follow the instructions to reset your password. The link will expire in 1 hour."})}),(0,a.jsxs)(n.z,{onClick:()=>s("login"),variant:"outline",className:"w-full bg-transparent border-[#606060] text-white hover:bg-[#404040]",children:[(0,a.jsx)(v.Z,{className:"w-4 h-4 mr-2"}),"Back to Login"]})]})]})}):(0,a.jsx)("div",{className:"flex items-center justify-center p-4 py-12",children:(0,a.jsxs)(l.Zb,{className:"w-full max-w-md bg-surface border-border shadow-2xl",children:[(0,a.jsxs)(l.Ol,{className:"text-center space-y-4",children:[(0,a.jsx)("div",{className:"mx-auto w-16 h-16 bg-[#4A90E2]/10 rounded-full flex items-center justify-center",children:(0,a.jsx)(c.Z,{className:"w-8 h-8 text-[#4A90E2]"})}),(0,a.jsx)(l.ll,{className:"text-2xl font-bold text-white",children:"Reset Password"}),(0,a.jsx)(l.SZ,{className:"text-[#B0B0B0]",children:"Enter your email address and we'll send you a link to reset your password"})]}),(0,a.jsxs)(l.aY,{className:"space-y-6",children:[(0,a.jsxs)("form",{onSubmit:y,className:"space-y-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("label",{className:"text-sm font-medium text-[#E0E0E0]",children:"SIT Email Address"}),(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)(d.Z,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-[#B0B0B0]"}),(0,a.jsx)(o.I,{type:"email",value:h,onChange:e=>x(e.target.value),className:"bg-[#404040] border-[#606060] text-white placeholder-[#B0B0B0] focus:border-[#4A90E2] pl-10",placeholder:"your.email@sit.ac.in",disabled:p})]}),g&&(0,a.jsx)("p",{className:"text-red-400 text-sm",children:g})]}),(0,a.jsx)(n.z,{type:"submit",disabled:p||!h.trim(),className:"w-full h-12 text-base font-semibold bg-[#4A90E2] hover:bg-[#4A90E2]/90 transition-all duration-200",children:p?(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("div",{className:"w-4 h-4 border-2 border-white/30 border-t-white rounded-full animate-spin"}),"Sending reset link..."]}):"Send Reset Link"})]}),(0,a.jsx)("div",{className:"text-center",children:(0,a.jsxs)("button",{onClick:()=>s("login"),className:"text-[#B0B0B0] hover:text-white text-sm flex items-center justify-center gap-2 mx-auto",disabled:p,children:[(0,a.jsx)(v.Z,{className:"w-4 h-4"}),"Back to login"]})})]})]})})}var _=t(5351);function U(e){let{initialStep:s="login"}=e,t=(0,r.useRouter)(),{session:l,loading:n,isLoggedIn:o,isReady:c}=(0,m.a)(),{updateProfile:d,userProfile:h}=(0,_.a)(),[x,g]=(0,i.useState)(s),[f,b]=(0,i.useState)({}),{toast:v}=(0,N.pm)(),[w,y]=(0,i.useState)(!1),D="".concat(n,"-").concat(o,"-").concat(!!l,"-").concat(x,"-").concat(c),[E,S]=(0,i.useState)("");D!==E&&(console.log("AuthFlow: State changed -",{loading:n,isLoggedIn:o,hasSession:!!l,hasUser:!!(null==l?void 0:l.user),currentStep:x,isReady:c,hasProfile:!!h,profileCompleted:null==h?void 0:h.profileCompleted}),S(D)),(0,i.useEffect)(()=>{if(!c||n){console.log("AuthFlow: Waiting for auth to be ready...",{isReady:c,loading:n});return}if(w)return;let e=new URLSearchParams(window.location.search).get("redirectTo")||null,s=!!((null==l?void 0:l.user)||o);if(console.log("AuthFlow: Auth check effect triggered",{isLoggedIn:o,hasSession:!!l,isAuthenticated:s,currentStep:x,redirectTo:e,isReady:c,hasProfile:!!h}),s&&e){if("otp-verification"===x){console.log("AuthFlow: In OTP verification, skipping redirect");return}console.log("AuthFlow: User authenticated, redirecting to:",e),y(!0),t.replace(e)}},[l,o,x,c,n,w,h]);let A=function(e){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};console.log("Step change:",e,s),g(e),b(e=>({...e,...s}))},B=async e=>{console.log("Profile creation completed:",e);try{console.log("Profile saved successfully"),b(s=>({...s,profile:e}));let s=new URLSearchParams(window.location.search).get("redirectTo")||"/dashboard";if(console.log("AuthFlow: Profile completed, ensuring profile refresh then redirecting to:",s),"function"==typeof d)try{await d(e),console.log("AuthFlow: Profile context updated successfully")}catch(e){console.warn("AuthFlow: Profile context update failed (continuing to redirect):",e)}console.log("AuthFlow: Using Next.js router for navigation to:",s),t.replace(s)}catch(e){console.error("Error saving profile:",e),v({title:"Failed to save profile",description:(null==e?void 0:e.message)||"Please try again.",variant:"destructive"})}};switch(x){case"signup":return(0,a.jsx)(p,{onStepChange:A});case"login":default:return(0,a.jsx)(u,{onStepChange:A});case"otp-verification":return(0,a.jsx)(j,{email:f.email,firstName:f.firstName,lastName:f.lastName,isSignUp:f.isSignUp,userData:f.userData,onStepChange:A});case"profile":return(0,a.jsx)("div",{className:"min-h-screen bg-background",children:(0,a.jsx)(k,{userData:f,onComplete:B})});case"forgot-password":return(0,a.jsx)(T,{onStepChange:A,initialEmail:f.email})}}t(2427)},6070:function(e,s,t){t.d(s,{Ol:function(){return l},SZ:function(){return o},Zb:function(){return r},aY:function(){return c},ll:function(){return n}});var a=t(7437);t(2265);var i=t(7062);function r(e){let{className:s,...t}=e;return(0,a.jsx)("div",{"data-slot":"card",className:(0,i.cn)("bg-card text-card-foreground flex flex-col gap-6 rounded-xl border py-6 shadow-sm",s),...t})}function l(e){let{className:s,...t}=e;return(0,a.jsx)("div",{"data-slot":"card-header",className:(0,i.cn)("@container/card-header grid auto-rows-min grid-rows-[auto_auto] items-start gap-1.5 px-6 has-data-[slot=card-action]:grid-cols-[1fr_auto] [.border-b]:pb-6",s),...t})}function n(e){let{className:s,...t}=e;return(0,a.jsx)("div",{"data-slot":"card-title",className:(0,i.cn)("leading-none font-semibold",s),...t})}function o(e){let{className:s,...t}=e;return(0,a.jsx)("div",{"data-slot":"card-description",className:(0,i.cn)("text-muted-foreground text-sm",s),...t})}function c(e){let{className:s,...t}=e;return(0,a.jsx)("div",{"data-slot":"card-content",className:(0,i.cn)("px-6",s),...t})}},5186:function(e,s,t){t.d(s,{I:function(){return l}});var a=t(7437),i=t(2265),r=t(7062);let l=i.forwardRef(function(e,s){let{className:t,type:i,...l}=e;return(0,a.jsx)("input",{ref:s,type:i,"data-slot":"input",className:(0,r.cn)("file:text-foreground placeholder:text-muted-foreground selection:bg-primary selection:text-primary-foreground dark:bg-input/30 border-input flex h-9 w-full min-w-0 rounded-md border bg-transparent px-3 py-1 text-base shadow-xs transition-[color,box-shadow] outline-none file:inline-flex file:h-7 file:border-0 file:bg-transparent file:text-sm file:font-medium disabled:pointer-events-none disabled:cursor-not-allowed disabled:opacity-50 md:text-sm","focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px]","aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",t),...l})})},6815:function(e,s,t){t.d(s,{_:function(){return l}});var a=t(7437);t(2265);var i=t(6394),r=t(7062);function l(e){let{className:s,...t}=e;return(0,a.jsx)(i.f,{"data-slot":"label",className:(0,r.cn)("flex items-center gap-2 text-sm leading-none font-medium select-none group-data-[disabled=true]:pointer-events-none group-data-[disabled=true]:opacity-50 peer-disabled:cursor-not-allowed peer-disabled:opacity-50",s),...t})}},2759:function(e,s,t){t.d(s,{E:function(){return l}});var a=t(7437);t(2265);var i=t(610),r=t(7062);function l(e){let{className:s,value:t,...l}=e;return(0,a.jsx)(i.fC,{"data-slot":"progress",className:(0,r.cn)("bg-primary/20 relative h-2 w-full overflow-hidden rounded-full",s),...l,children:(0,a.jsx)(i.z$,{"data-slot":"progress-indicator",className:"bg-primary h-full w-full flex-1 transition-all",style:{transform:"translateX(-".concat(100-(t||0),"%)")}})})}},6818:function(e,s,t){t.d(s,{g:function(){return r}});var a=t(7437);t(2265);var i=t(7062);function r(e){let{className:s,...t}=e;return(0,a.jsx)("textarea",{"data-slot":"textarea",className:(0,i.cn)("border-input placeholder:text-muted-foreground focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:bg-input/30 flex field-sizing-content min-h-16 w-full rounded-md border bg-transparent px-3 py-2 text-base shadow-xs transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",s),...t})}},5153:function(e,s,t){t.d(s,{pm:function(){return u}});var a=t(2265);let i=0,r=new Map,l=e=>{if(r.has(e))return;let s=setTimeout(()=>{r.delete(e),d({type:"REMOVE_TOAST",toastId:e})},1e6);r.set(e,s)},n=(e,s)=>{switch(s.type){case"ADD_TOAST":return{...e,toasts:[s.toast,...e.toasts].slice(0,1)};case"UPDATE_TOAST":return{...e,toasts:e.toasts.map(e=>e.id===s.toast.id?{...e,...s.toast}:e)};case"DISMISS_TOAST":{let{toastId:t}=s;return t?l(t):e.toasts.forEach(e=>{l(e.id)}),{...e,toasts:e.toasts.map(e=>e.id===t||void 0===t?{...e,open:!1}:e)}}case"REMOVE_TOAST":if(void 0===s.toastId)return{...e,toasts:[]};return{...e,toasts:e.toasts.filter(e=>e.id!==s.toastId)}}},o=[],c={toasts:[]};function d(e){c=n(c,e),o.forEach(e=>{e(c)})}function m(e){let{...s}=e,t=(i=(i+1)%Number.MAX_SAFE_INTEGER).toString(),a=()=>d({type:"DISMISS_TOAST",toastId:t});return d({type:"ADD_TOAST",toast:{...s,id:t,open:!0,onOpenChange:e=>{e||a()}}}),{id:t,dismiss:a,update:e=>d({type:"UPDATE_TOAST",toast:{...e,id:t}})}}function u(){let[e,s]=a.useState(c);return a.useEffect(()=>(o.push(s),()=>{let e=o.indexOf(s);e>-1&&o.splice(e,1)}),[e]),{...e,toast:m,dismiss:e=>d({type:"DISMISS_TOAST",toastId:e})}}},7030:function(e,s,t){t.d(s,{zA:function(){return i}});let a={cs:"Computer Science",is:"Information Science",ec:"Electronics & Communication",me:"Mechanical Engineering",cv:"Civil Engineering",ee:"Electrical Engineering",ae:"Aeronautical Engineering",bt:"Biotechnology",ch:"Chemical Engineering",im:"Industrial Engineering & Management",tc:"Telecommunication Engineering",ai:"Artificial Intelligence & Machine Learning",ds:"Data Science",cy:"Cyber Security"};function i(e){try{if(!(e&&"string"==typeof e&&e.toLowerCase().endsWith("@".concat("sit.ac.in"))))throw Error("Invalid institutional email domain");let s=e.split("@")[0].toLowerCase(),t=s.match(/^(\d)([a-z]{2})(\d{2})([a-z]{2})(\d{3})$/);if(!t)throw Error("Invalid USN format in email");let[,i,r,l,n,o]=t,c=new Date().getFullYear(),d=100*Math.floor(c/100)+parseInt(l);d>c+10&&(d-=100);let m=d+4,u=a[n];if(!u)throw Error("Unknown branch code: ".concat(n));return{usn:s.toUpperCase(),branch:u,branchCode:n.toUpperCase(),joiningYear:d,passingYear:m,semester:parseInt(i),rollNumber:parseInt(o),isValid:!0}}catch(e){return console.error("Email parsing error:",e.message),{isValid:!1,error:e.message}}}}}]);